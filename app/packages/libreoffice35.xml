<?xml version="1.0" encoding="UTF-8"?>
<packages>
<package
    id="libreoffice35"
    name="LibreOffice 3.5 : La suite bureautique Libre"
    revision="%version_long%"
    reboot="false"
    priority="3">

    <!--    <depends package-id="Java" />
            -->
    <eoledl dl="http://download.documentfoundation.org/libreoffice/old/%version_long%/win/x86/LibO_%version_long%_Win_x86_install_multi.msi" destname="libreoffice/LibO_%version_long%_Win_x86_install_multi.msi" />
    <variable name="version_long" value="3.5.7" />
    <variable name="version" value="3.5" />
    <variable name="version_short" value="35" />
    <variable name="CNAME" value="Education Nationale" />
    <variable name="INSTALLLOCATION" value="%ProgramFiles%\LibreOffice %version%" />


<!-- Programmes supprimés de l'installation complète (ici Base et Maths), même principe pour Calc, Impress, Wrt ou Draw -->
    <variable name="REMOVEPROGS" value="gm_p_Base,gm_p_Base_Bin,gm_p_Math,gm_p_Math_Bin" />

<!-- Options de LibreOffice supprimées de l'installation complète, vous pouvez éventuellement ajouter gm_o_Quickstart (Démarrage rapide), gm_o_Grfflt (import des graphiques (gm_o_Testtool n'existe plus en 3.5)-->
    <variable name="REMOVEOPTIONS" value="gm_o_Xsltfiltersamples,gm_o_Binfilter,gm_o_Pyuno,gm_o_Onlineupdate,gm_o_Javafilter,gm_o_jf_Palm,gm_o_jf_Palm_Aportisdoc,gm_o_jf_Pocketpc,gm_o_jf_Pocketpc_Pocket_Word,gm_o_jf_Pocketpc_Pocket_Excel" />

<!-- Extensions normalement fournies à l'installation supprimées du déploiement, vous pouvez ajouter gm_o_Extensions_PDFIMPORT,gm_o_Extensions_MINIMIZER,gm_o_Extensions_MEDIAWIKI -->
    <variable name="REMOVEEXTENSIONS" value="gm_o_Extensions_MEDIAWIKI,gm_o_Extensions_REPORTDESIGN,gm_o_Extensions_Script_Provider_For_Javascript,gm_o_Extensions_Script_Provider_For_Beanshell,gm_o_Extensions_PRESENTER_SCREEN,gm_o_Extensions_NLPSolver,gm_o_Extensions_Script_Provider_For_Python" />

<!-- Pack de langues à supprimer à l'installation, on ne gardera que le francais (gm_Langpack_r_fr) et l'anglais (gm_Langpack_r_en_US et gm_Langpack_r_en_GB)-->
<!-- Vous pouvez rajouter des langues à LibO en enlevant l'espagnol gm_Langpack_r_en_es, l'italien gm_Langpack_r_en_it, l'allemand gm_Langpack_r_en_de, le grec gm_Langpack_r_en_el, le japonais gm_Langpack_r_en_ja, le portugais gm_Langpack_r_en_pt, le chinois simplifié gm_Langpack_r_en_zh_CN ou le breton gm_Langpack_r_en_br -->
    <variable name="REMOVELANGAGES" value="gm_Langpack_r_zu,gm_Langpack_r_zh_TW,gm_Langpack_r_xh,gm_Langpack_r_vi,gm_Langpack_r_ve,gm_Langpack_r_uz,gm_Langpack_r_uk,gm_Langpack_r_ug,gm_Langpack_r_ts,gm_Langpack_r_tr,gm_Langpack_r_tn,gm_Langpack_r_th,gm_Langpack_r_tg,gm_Langpack_r_te,gm_Langpack_r_ta,gm_Langpack_r_sw_TZ,gm_Langpack_r_sv,gm_Langpack_r_st,gm_Langpack_r_ss,gm_Langpack_r_sr,gm_Langpack_r_sq,gm_Langpack_r_sl,gm_Langpack_r_sk,gm_Langpack_r_si,gm_Langpack_r_sh,gm_Langpack_r_sd,gm_Langpack_r_sat,gm_Langpack_r_sa_IN,gm_Langpack_r_rw,gm_Langpack_r_ro,gm_Langpack_r_pt,gm_Langpack_r_pl,gm_Langpack_r_or,gm_Langpack_r_om,gm_Langpack_r_oc,gm_Langpack_r_nso,gm_Langpack_r_nr,gm_Langpack_r_nn,gm_Langpack_r_nl,gm_Langpack_r_ne,gm_Langpack_r_nb,gm_Langpack_r_my,gm_Langpack_r_mr,gm_Langpack_r_mni,gm_Langpack_r_mn,gm_Langpack_r_ml,gm_Langpack_r_mk,gm_Langpack_r_mai,gm_Langpack_r_lv,gm_Langpack_r_lt,gm_Langpack_r_lo,gm_Langpack_r_ku,gm_Langpack_r_ks,gm_Langpack_r_ko,gm_Langpack_r_kn,gm_Langpack_r_km,gm_Langpack_r_kk,gm_Langpack_r_ka,gm_Langpack_r_ja,gm_Langpack_r_is,gm_Langpack_r_id,gm_Langpack_r_hu,gm_Langpack_r_hr,gm_Langpack_r_hi,gm_Langpack_r_gu,gm_Langpack_r_gl,gm_Langpack_r_gd,gm_Langpack_r_ga,gm_Langpack_r_fi,gm_Langpack_r_fa,gm_Langpack_r_eu,gm_Langpack_r_eo,gm_Langpack_r_en_ZA,gm_Langpack_r_dz,gm_Langpack_r_dgo,gm_Langpack_r_da,gm_Langpack_r_cy,gm_Langpack_r_cs,gm_Langpack_r_ca,gm_Langpack_r_bs,gm_Langpack_r_brx,gm_Langpack_r_bo,gm_Langpack_r_bn,gm_Langpack_r_bg,gm_Langpack_r_be,gm_Langpack_r_ast,gm_Langpack_r_as,gm_Langpack_r_ar,gm_Langpack_r_af,gm_Langpack_r_kok,gm_Langpack_r_br,gm_Langpack_r_es,gm_Langpack_r_pt_BR,gm_Langpack_r_pa_IN,gm_Langpack_r_ru,gm_Langpack_r_et,gm_Langpack_r_de,gm_Langpack_r_el,gm_Langpack_r_he,gm_Langpack_r_it,gm_Langpack_r_ca_XV,gm_Langpack_r_zh_CN" />

<!-- Dictionnaires que l'on supprime, tous sauf le français et l'anglais. Enlever gm_r_Extension_Dictionary_Es pour Espagnol, It pour Italien, De pour Allemand... -->
    <variable name="REMOVEDICOS" value="gm_r_ex_Dictionary_Af,gm_r_ex_Dictionary_An,gm_r_ex_Dictionary_Ar,gm_r_ex_Dictionary_Be,gm_r_ex_Dictionary_Bg,gm_r_ex_Dictionary_Bn,gm_r_ex_Dictionary_Br,gm_r_ex_Dictionary_Da,gm_r_ex_Dictionary_Pt,gm_r_ex_Dictionary_Ca,gm_r_ex_Dictionary_El,gm_r_ex_Dictionary_Pt_Pt,gm_r_ex_Dictionary_Si,gm_r_ex_Dictionary_Hi,gm_r_ex_Dictionary_Gu,gm_r_ex_Dictionary_Gd,gm_r_ex_Dictionary_Lt,gm_r_ex_Dictionary_Hr,gm_r_ex_Dictionary_Cs,gm_r_ex_Dictionary_Nl,gm_r_ex_Dictionary_Et,gm_r_ex_Dictionary_De,gm_r_ex_Dictionary_He,gm_r_ex_Dictionary_Hu,gm_r_ex_Dictionary_It,gm_r_ex_Dictionary_Ku_Tr,gm_r_ex_Dictionary_Lv,gm_r_ex_Dictionary_Ne,gm_r_ex_Dictionary_No,gm_r_ex_Dictionary_Oc,gm_r_ex_Dictionary_Pl,gm_r_ex_Dictionary_Ro,gm_r_ex_Dictionary_Sr,gm_r_ex_Dictionary_Sk,gm_r_ex_Dictionary_Sl,gm_r_ex_Dictionary_Es,gm_r_ex_Dictionary_Sv,gm_r_ex_Dictionary_Th,gm_r_ex_Dictionary_Uk,gm_r_ex_Dictionary_Vi,gm_r_ex_Dictionary_Zu,gm_r_ex_Dictionary_Ru,gm_r_ex_Dictionary_Gl,gm_r_ex_Dictionary_Te" />

    <check type="file" condition="versiongreaterorequal" path="%ProgramFiles%\LibreOffice %version%\program\soffice.exe" value="%version%"/>

<!-- REGISTER_ALL_MSO_TYPES=1 : les fichiers OFFICE s'ouvriront avec LibO -->
    <install cmd='msiexec /qn /I "%SOFTWARE%\libreoffice\LibO_%version_long%_Win_x86_install_multi.msi" INSTALLLOCATION="%INSTALLLOCATION%" COMPANYNAME="%CNAME%" USERNAME="" REGISTER_ALL_MSO_TYPES=1 ISCHECKFORPRODUCTUPDATE=0 CREATEDESKTOPLINK=0 ADDLOCAL=ALL REMOVE=%REMOVEPROGS%,%REMOVEOPTIONS%,%REMOVEEXTENSIONS%,%REMOVELANGAGES%,%REMOVEDICOS%' />

    <upgrade cmd='msiexec /qn /I "%SOFTWARE%\libreoffice\LibO_%version_long%_Win_x86_install_multi.msi" INSTALLLOCATION="%INSTALLLOCATION%" COMPANYNAME="%CNAME%" USERNAME="" REGISTER_ALL_MSO_TYPES=1 ISCHECKFORPRODUCTUPDATE=0 CREATEDESKTOPLINK=0 ADDLOCAL=ALL REMOVE=%REMOVEPROGS%,%REMOVEOPTIONS%,%REMOVEEXTENSIONS%,%REMOVELANGAGES%,%REMOVEDICOS%' />
    <downgrade cmd='msiexec /qn /I "%SOFTWARE%\libreoffice\LibO_%version_long%_Win_x86_install_multi.msi" INSTALLLOCATION="%INSTALLLOCATION%" COMPANYNAME="%CNAME%" USERNAME="" REGISTER_ALL_MSO_TYPES=1 ISCHECKFORPRODUCTUPDATE=0 CREATEDESKTOPLINK=0 ADDLOCAL=ALL REMOVE=%REMOVEPROGS%,%REMOVEOPTIONS%,%REMOVEEXTENSIONS%,%REMOVELANGAGES%,%REMOVEDICOS%' />

    <remove cmd='msiexec /qn /X "%SOFTWARE%\libreoffice\LibO_%version_long%_Win_x86_install_multi.msi"' />
    <remove cmd='%COMSPEC% /C if exist "%ProgramFiles%\LibreOffice %version%" rmdir /S /Q "%ProgramFiles%\LibreOffice %version%"'/>

</package>
</packages>
